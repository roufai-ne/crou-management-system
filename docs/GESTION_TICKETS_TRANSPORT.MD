# ğŸ“‹ PROMPT : Ajout Gestion Tickets & Situations JournaliÃ¨res - Transport CROU

## ğŸ¯ Contexte & Objectif

**SystÃ¨me** : Module Transport CROU (Niger) - Existant
**Scope** : Ajout de 2 composantes manquantes
**Objectif** : 
1. âœ… GÃ©rer les **tickets de transport** vendus aux usagers (Ã©tudiants, ayant-droit, etc.)
2. âœ… GÃ©nÃ©rer des **situations journaliÃ¨res** consolidant navettes + recettes + KPIs

**Devise** : FCFA | **Localisation** : Niger

---

## ğŸ“Š Ã‰TAT ACTUEL (Module existant)

Le module Transport gÃ¨re actuellement :
- âœ… Parc automobile (bus, immatriculation, capacitÃ©, Ã©tat)
- âœ… Journal de bord quotidien (navettes par vÃ©hicule, circuits, km, carburant)
- âœ… Suivi consommation carburant (mensuel)
- âœ… Maintenance vÃ©hicules
- âœ… Tableau de bord KPIs (disponibilitÃ©, consommation, ponctualitÃ©, passagers)

**Manquant** :
- âŒ Gestion des **tickets vendus** (types, tarifs, Ã©mission, validation)
- âŒ **Situation journaliÃ¨re consolidÃ©e** (frÃ©quentation, recettes, Ã©tat navettes)
- âŒ **Rapports financiers** (recettes transport)

---

## ğŸ”„ WORKFLOWS Ã€ IMPLÃ‰MENTER

### WORKFLOW 1 : Ã‰mission de Tickets de Transport

```
[AGENT TICKETING] AccÃ¨de interface "Ã‰mettre Tickets Transport"
â”‚
â”œâ”€ SÃ©lectionne :
â”‚  â”œâ”€ Date de transport
â”‚  â”œâ”€ Parcours/Circuit (ex: Centre â†’ Campus)
â”‚  â”œâ”€ Type ticket (RÃ©gulier, Ã‰tudiant, Personnel, Ayant-droit, etc.)
â”‚  â””â”€ QuantitÃ© tickets
â”‚
â–¼
[SYSTÃˆME] Affiche :
â”‚  â”œâ”€ Prix unitaire (paramÃ©trÃ© par circuit + type)
â”‚  â”œâ”€ Montant total calculÃ©
â”‚  â””â”€ VÃ©hicules disponibles (basÃ© sur parc)
â”‚
â–¼
[AGENT] Clique "Ã‰mettre tickets"
â”‚
â–¼
[SYSTÃˆME] Enregistre & affiche confirmation
â”‚  â”œâ”€ NumÃ©ro de sÃ©rie tickets
â”‚  â”œâ”€ Montant total
â”‚  â””â”€ Statut : "Ã€ encaisser"
â”‚
â–¼
[RAPPROCHEMENT FINANCIER] Tickets listÃ©s en attente d'encaissement
```

### WORKFLOW 2 : Situation JournaliÃ¨re

```
[GESTIONNAIRE TRANSPORT] AccÃ¨de "Situations JournaliÃ¨res"
â”‚
â”œâ”€ SÃ©lectionne date
â”‚
â–¼
[SYSTÃˆME] AgrÃ¨ge automatiquement :
â”‚
â”œâ”€ NAVETTES DU JOUR :
â”‚  â”œâ”€ Nombre de navettes effectuÃ©es
â”‚  â”œâ”€ VÃ©hicules utilisÃ©s
â”‚  â”œâ”€ Total passagers transportÃ©s
â”‚  â”œâ”€ Carburant consommÃ© (L)
â”‚  â””â”€ Distance totale (km)
â”‚
â”œâ”€ TICKETS VENDUS :
â”‚  â”œâ”€ Par type (rÃ©gulier, Ã©tudiant, personnel, etc.)
â”‚  â”œâ”€ Nombre total
â”‚  â””â”€ Recettes total
â”‚
â”œâ”€ INDICATEURS KPI :
â”‚  â”œâ”€ Taux remplissage moyen (% capacitÃ©)
â”‚  â”œâ”€ Rendement/km (passagers/km)
â”‚  â”œâ”€ CoÃ»t carburant
â”‚  â””â”€ PonctualitÃ© estimÃ©e
â”‚
â””â”€ ANOMALIES :
   â”œâ”€ VÃ©hicules non disponibles
   â”œâ”€ Navettes annulÃ©es
   â””â”€ DÃ©passements carburant
â”‚
â–¼
[INTERFACE] Affiche tableau de synthÃ¨se (peut exporter PDF/Excel)
```

---

## ğŸ—„ï¸ MODÃˆLES DE DONNÃ‰ES Ã€ AJOUTER

### 1. Circuits de Transport

```sql
CREATE TABLE circuits_transport (
  circuit_id UUID PRIMARY KEY,
  nom_circuit VARCHAR(255) NOT NULL,
  trajet_depart VARCHAR(255),
  trajet_arrivee VARCHAR(255),
  distance_km DECIMAL(10,2),
  duree_minutes INT,
  statut ENUM('Actif', 'Inactif', 'Suspendu'),
  description TEXT,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);

-- Exemple:
-- circuit_1 | Centre â†’ Campus | Centre ville | Campus principal | 15.5 km | 45 min
-- circuit_2 | Campus â†’ Campus | Campus A | Campus B | 8.3 km | 25 min
```

### 2. Tarifs de Transport

```sql
CREATE TABLE tarifs_transport (
  tarif_id UUID PRIMARY KEY,
  circuit_id FK circuits_transport,
  type_ticket ENUM('RÃ©gulier', 'Ã‰tudiant', 'Personnel', 'Ayant_Droit', 'Gratuit'),
  prix_unitaire DECIMAL(10,2) NOT NULL,  -- FCFA
  statut ENUM('Actif', 'Inactif'),
  date_debut DATE,
  date_fin DATE,
  notes TEXT,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);

-- Exemple:
-- circuit_1 | RÃ©gulier | 500 FCFA
-- circuit_1 | Ã‰tudiant | 250 FCFA
-- circuit_1 | Personnel | 350 FCFA
```

### 3. CatÃ©gories de Tickets de Transport

```sql
CREATE TABLE categories_tickets_transport (
  categorie_id UUID PRIMARY KEY,
  nom_categorie VARCHAR(255),
  prix_unitaire DECIMAL(10,2),
  description TEXT,
  statut ENUM('Actif', 'Inactif'),
  couleur_badge VARCHAR(50),  -- Pour affichage UI
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

### 4. Tickets de Transport Ã‰mis

```sql
CREATE TABLE tickets_transport (
  ticket_id UUID PRIMARY KEY,
  circuit_id FK circuits_transport,
  date_transport DATE,
  categorie_id FK categories_tickets_transport,
  quantite INT NOT NULL,
  prix_unitaire DECIMAL(10,2),
  montant_total DECIMAL(10,2),  -- CalculÃ©
  statut_validation ENUM('Ã‰mis', 'ValidÃ©', 'EncaissÃ©', 'AnnulÃ©'),
  numero_serie_debut INT,
  numero_serie_fin INT,
  emis_par FK users,
  validÃ©_par FK users (nullable),
  date_emission DATETIME,
  date_validation DATETIME (nullable),
  notes TEXT,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);

-- Index sur :
-- (circuit_id, date_transport)
-- (statut_validation, date_emission)
```

### 5. Navettes RÃ©alisÃ©es (Lien avec parc automobile existant)

```sql
CREATE TABLE navettes_transport (
  navette_id UUID PRIMARY KEY,
  date_navette DATE,
  circuit_id FK circuits_transport,
  vehicule_id FK parc_automobile (existant),
  chauffeur_id FK users,
  heure_depart TIME,
  heure_arrivee TIME,
  nombre_passagers INT,
  km_depart INT,
  km_arrivee INT,
  distance_km DECIMAL(10,2),  -- CalculÃ©
  carburant_consomme DECIMAL(10,2),  -- L
  taux_remplissage_percent DECIMAL(5,2),  -- (passagers / capacitÃ©_vehicule * 100)
  ponctualite_minutes INT,  -- Retard (+) ou avance (-)
  statut ENUM('PlanifiÃ©e', 'En cours', 'ComplÃ©tÃ©e', 'AnnulÃ©e'),
  observations TEXT,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);

-- Index sur :
-- (date_navette, circuit_id)
-- (vehicule_id, date_navette)
```

### 6. Situation JournaliÃ¨re (Vue AgrÃ©gÃ©e)

```sql
CREATE TABLE situations_journalieres_transport (
  situation_id UUID PRIMARY KEY,
  date_situation DATE UNIQUE,
  crou_id FK crou,
  
  -- Navettes
  nombre_navettes INT,
  nombre_vehicules_utilises INT,
  total_passagers INT,
  total_km DECIMAL(10,2),
  total_carburant DECIMAL(10,2),
  
  -- Tickets & Recettes
  tickets_emis INT,
  montant_recettes DECIMAL(12,2),
  tickets_encaisses INT,
  montant_encaisse DECIMAL(12,2),
  
  -- KPIs
  taux_remplissage_moyen DECIMAL(5,2),  -- %
  taux_disponibilite_flotte DECIMAL(5,2),  -- %
  cout_carburant_journalier DECIMAL(10,2),
  ponctualite_moyenne DECIMAL(5,2),  -- %
  
  -- Anomalies
  nb_anomalies INT,
  anomalies_detail JSON,  -- [{type, description}, ...]
  
  statut ENUM('Brouillon', 'ValidÃ©', 'FinalisÃ©'),
  notes TEXT,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

---

## ğŸ¨ INTERFACES UTILISATEUR

### 1. Ã‰mission de Tickets Transport

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ã‰mettre Tickets de Transport                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  Date transport:        [24/04/2025]            â”‚
â”‚  Circuit:              [SÃ©lectionner â–¼]         â”‚
â”‚                        â†’ Centre â†’ Campus (15km) â”‚
â”‚                                                  â”‚
â”‚  Type ticket:          [RÃ©gulier â–¼]             â”‚
â”‚  Prix unitaire:        500 FCFA                 â”‚
â”‚                                                  â”‚
â”‚  QuantitÃ©:             [___50___]               â”‚
â”‚  Montant total:        25,000 FCFA âœ“            â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [Annuler]  [Ã‰mettre Tickets]            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ 50 tickets Ã©mis (#000501-000550)              â”‚
â”‚   Montant: 25,000 FCFA - Statut: Ã€ encaisser   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Tableau Historique Tickets

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Historique Tickets de Transport                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Filtres: [Date â–¼] [Circuit â–¼] [Statut â–¼]  [Rechercher...]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Date      Circuit           Type      Qty   Montant   Statut  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 24/04     Centreâ†’Campus    RÃ©gulier   50    25,000   EncaissÃ© â”‚
â”‚ 24/04     Campus Aâ†’B       Ã‰tudiant   30    7,500    ValidÃ©   â”‚
â”‚ 24/04     Centreâ†’Campus    Gratuit    5     0        ValidÃ©   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Situation JournaliÃ¨re

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SITUATION JOURNALIÃˆRE - 24 Avril 2025                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  ğŸ“Š NAVETTES DU JOUR                                          â”‚
â”‚  â”œâ”€ Navettes rÃ©alisÃ©es : 12                                   â”‚
â”‚  â”œâ”€ VÃ©hicules utilisÃ©s : 3                                    â”‚
â”‚  â”œâ”€ Total passagers : 850                                     â”‚
â”‚  â”œâ”€ Distance totale : 187.5 km                                â”‚
â”‚  â””â”€ Carburant consommÃ© : 47.3 L                               â”‚
â”‚                                                               â”‚
â”‚  ğŸ’° TICKETS & RECETTES                                        â”‚
â”‚  â”œâ”€ Tickets rÃ©gulier : 400 Ã— 500 = 200,000 FCFA              â”‚
â”‚  â”œâ”€ Tickets Ã©tudiant : 350 Ã— 250 = 87,500 FCFA               â”‚
â”‚  â”œâ”€ Tickets personnel : 100 Ã— 350 = 35,000 FCFA              â”‚
â”‚  â”œâ”€ GratuitÃ©s : 0 FCFA                                        â”‚
â”‚  â””â”€ TOTAL RECETTES : 322,500 FCFA                             â”‚
â”‚                                                               â”‚
â”‚  ğŸ“ˆ INDICATEURS KPI                                           â”‚
â”‚  â”œâ”€ Taux remplissage moyen : 81% âœ“                            â”‚
â”‚  â”œâ”€ Taux disponibilitÃ© flotte : 100% âœ“                        â”‚
â”‚  â”œâ”€ CoÃ»t carburant/jour : ~7,360 FCFA                         â”‚
â”‚  â”œâ”€ PonctualitÃ© moyenne : 92% âœ“                               â”‚
â”‚  â””â”€ Rendement moyen : 4.5 passagers/km                        â”‚
â”‚                                                               â”‚
â”‚  âš ï¸ ANOMALIES                                                 â”‚
â”‚  â””â”€ Aucune                                                    â”‚
â”‚                                                               â”‚
â”‚  [Exporter PDF] [Exporter Excel] [Imprimer]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Dashboard Transport Widget

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸšŒ TRANSPORT AUJOURD'HUI     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Navettes : 12               â”‚
â”‚ Passagers : 850             â”‚
â”‚ Recettes : 322,500 FCFA     â”‚
â”‚ Ã‰tat : âœ“ Normal             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ INTÃ‰GRATIONS AVEC MODULE EXISTANT

### 1. RÃ©cupÃ©ration VÃ©hicules Disponibles
```javascript
// Avant d'Ã©mettre tickets, rÃ©cupÃ©rer vÃ©hicules pour affichage
GET /api/transport/parc-automobile?statut=Disponible&date=YYYY-MM-DD
â””â”€ Retourne liste bus disponibles + capacitÃ©
```

### 2. RÃ©cupÃ©ration Journal de Bord du Jour
```javascript
// Pour construire situation journaliÃ¨re
GET /api/transport/navettes?date=YYYY-MM-DD
â””â”€ Retourne toutes navettes du jour avec passagers, km, carburant
```

### 3. RÃ©cupÃ©ration DonnÃ©es Carburant
```javascript
// Pour calculs KPI
GET /api/transport/carburant/jour?date=YYYY-MM-DD
â””â”€ Retourne consommation + coÃ»ts du jour
```

### 4. RÃ©cupÃ©ration Maintenance
```javascript
// Pour alertes disponibilitÃ©
GET /api/transport/maintenance/alerts?date=YYYY-MM-DD
â””â”€ Retourne vÃ©hicules en maintenance ce jour
```

---

## ğŸ“‹ SPÃ‰CIFICATIONS FONCTIONNELLES

### Gestion Tickets

| Feature | DÃ©tail |
|---------|--------|
| **CrÃ©er catÃ©gories** | Types tickets : RÃ©gulier, Ã‰tudiant, Personnel, Ayant-Droit, Gratuit |
| **ParamÃ©trer tarifs** | Par circuit + type ticket |
| **Ã‰mettre tickets** | Batch (50, 100, etc.) ou individuels |
| **Validation statuts** | Ã‰mis â†’ ValidÃ© â†’ EncaissÃ© |
| **NumÃ©rotation** | Automatique (sÃ©rie contiguÃ«) |
| **Historique** | Tous les mouvements tracÃ©s |
| **Rapprochement** | Tickets Ã©mis vs encaissements |

### Situations JournaliÃ¨res

| Feature | DÃ©tail |
|---------|--------|
| **GÃ©nÃ©ration auto** | Ã€ minuit ou Ã  la demande |
| **AgrÃ©gation** | Navettes + Tickets + Carburant + Maintenance |
| **Calcul KPI** | Automatique (% remplissage, ponctualitÃ©, etc.) |
| **Anomalies** | DÃ©tection auto (retards, anomalies) |
| **Historique** | Garde situation pour chaque jour |
| **Exports** | PDF + Excel avec mise en forme |
| **Rapports** | Journalier, hebdo, mensuel |

---

## ğŸ” PERMISSIONS & AUDIT

### RÃ´les
| RÃ´le | Tickets | Situations |
|------|---------|-----------|
| **Admin Transport** | âœ“ CRUD | âœ“ CRUD |
| **Gestionnaire Transport** | âœ“ Lecture + Ã‰mission | âœ“ Lecture + GÃ©nÃ©ration |
| **Agent Ticketing** | âœ“ Ã‰mettre seulement | âœ“ Lecture seulement |
| **Comptable** | âœ“ Lecture (rapprochement) | âœ“ Lecture (rapprochement) |

### Audit Trail
- Logging : User + Action + Timestamp + Avant/AprÃ¨s
- Immuable : Pas de suppression directe (soft-delete)
- Export audit : Mensuel pour conformitÃ©

---

## ğŸ”Œ API ENDPOINTS Ã€ CRÃ‰ER

### Circuits & Tarifs
```javascript
GET    /api/transport/circuits
POST   /api/transport/circuits
PUT    /api/transport/circuits/{circuit_id}
DELETE /api/transport/circuits/{circuit_id}

GET    /api/transport/tarifs?circuit_id=
POST   /api/transport/tarifs
PUT    /api/transport/tarifs/{tarif_id}
```

### CatÃ©gories Tickets
```javascript
GET    /api/transport/categories-tickets
POST   /api/transport/categories-tickets
PUT    /api/transport/categories-tickets/{id}
DELETE /api/transport/categories-tickets/{id}
```

### Tickets Transport
```javascript
GET    /api/transport/tickets?date_from=&date_to=&circuit=
POST   /api/transport/tickets                    // Ã‰mettre
GET    /api/transport/tickets/{ticket_id}
PATCH  /api/transport/tickets/{ticket_id}/valider
PATCH  /api/transport/tickets/{ticket_id}/encaisser
DELETE /api/transport/tickets/{ticket_id}       // Soft-delete (annulation)
```

### Navettes
```javascript
GET    /api/transport/navettes?date=
POST   /api/transport/navettes                  // CrÃ©er (intÃ©gration journal bord)
```

### Situations JournaliÃ¨res
```javascript
GET    /api/transport/situations?date=&mois=&annee=
POST   /api/transport/situations/{date}/generer
GET    /api/transport/situations/{situation_id}
POST   /api/transport/situations/{situation_id}/export-pdf
POST   /api/transport/situations/{situation_id}/export-excel
```

---

## ğŸ“Š RAPPORTS Ã€ GÃ‰NÃ‰RER

### 1. Rapport Journalier (JSON)
```json
{
  "date": "2025-04-24",
  "navettes": {
    "total": 12,
    "vehicules_utilises": 3,
    "passagers": 850,
    "km_total": 187.5,
    "carburant_total_litres": 47.3
  },
  "tickets": {
    "par_type": [
      { "type": "RÃ©gulier", "quantite": 400, "montant": 200000 },
      { "type": "Ã‰tudiant", "quantite": 350, "montant": 87500 }
    ],
    "montant_total": 322500
  },
  "kpi": {
    "taux_remplissage_percent": 81,
    "taux_disponibilite_percent": 100,
    "ponctualite_percent": 92,
    "cout_carburant": 7360
  }
}
```

### 2. Rapport Mensuel
- SynthÃ¨se par jour
- Moyennes journaliÃ¨res
- Tendances (vs mois prÃ©cÃ©dent)
- Top circuits (par frÃ©quentation)
- Anomalies rÃ©currentes

### 3. Rapport Annuel
- SynthÃ¨se par mois
- Tendances annuelles
- Ã‰volution tarifs/recettes
- Analyse flotte (utilisation, Ã¢ge, maintenance)

---

## âœ… CRITÃˆRES DE SUCCÃˆS

- âœ… Ã‰mission de tickets simple & fiable (batch)
- âœ… Situation journaliÃ¨re auto-gÃ©nÃ©rÃ©e avec donnÃ©es exactes
- âœ… KPI calculÃ©s correctement (% remplissage, ponctualitÃ©, etc.)
- âœ… Rapprochement tickets vs encaissements transparent
- âœ… Exports PDF/Excel professionnels
- âœ… IntÃ©gration fluide avec parc automobile existant
- âœ… Audit trail complet (traÃ§abilitÃ© tickets)
- âœ… Dashboard intÃ©grÃ© aux dashboards existants
- âœ… Tarifs paramÃ©trables par circuit + type
- âœ… Aucune perte de donnÃ©es lors des opÃ©rations

---

## ğŸ“ PARAMÃˆTRES INITIAUX (Ã€ CONFIRMER)

**Circuits Transport** :
```
- Circuit 1 : Centre â†’ Campus (15 km)
- Circuit 2 : Campus A â†’ Campus B (8 km)
- (Ã€ complÃ©ter avec autre circuits)
```

**Tarifs Actuels** :
```
Ã€ dÃ©finir par circuit et type ticket
Exemple:
- RÃ©gulier : 500 FCFA
- Ã‰tudiant : 250 FCFA
- Personnel : 350 FCFA
- Gratuit : 0 FCFA
```

**VÃ©hicules** :
```
- Bus 1 : CapacitÃ© 70 pers (imm1)
- Bus 2 : CapacitÃ© 70 pers (imm2)
(RÃ©cupÃ©rÃ©s du parc automobile existant)
```

---

## ğŸ“… PHASES D'IMPLÃ‰MENTATION

### Phase 1 : Fondations (1 sem)
- [ ] ModÃ¨les BD (Circuits, Tarifs, CatÃ©gories, Tickets, Navettes, Situations)
- [ ] Migrations
- [ ] Seed data (circuits, tarifs, catÃ©gories)

### Phase 2 : API Tickets (1 sem)
- [ ] CRUD Circuits + Tarifs
- [ ] CRUD CatÃ©gories Tickets
- [ ] Ã‰mission & validation tickets
- [ ] Tests

### Phase 3 : Situation JournaliÃ¨re (1 sem)
- [ ] API gÃ©nÃ©ration situations
- [ ] Calculs KPI
- [ ] DÃ©tection anomalies
- [ ] Tests

### Phase 4 : Frontend & Exports (1 sem)
- [ ] Pages Ã©mission tickets
- [ ] Historique tickets
- [ ] Affichage situation journaliÃ¨re
- [ ] Exports PDF/Excel

### Phase 5 : Integration & Dashboard (0.5 sem)
- [ ] Widget dashboard transport
- [ ] IntÃ©gration avec parc automobile
- [ ] Rapprochement financier (si module finances existe)
- [ ] Polish & tests

**Total : ~4.5 semaines**

---

## ğŸ DELIVERABLES

```
â”œâ”€ Code source
â”‚  â”œâ”€ API endpoints (Express/FastAPI)
â”‚  â”œâ”€ Frontend (React/Next.js pages)
â”‚  â””â”€ Tests (unitaires + intÃ©gration)
â”œâ”€ Documentation
â”‚  â”œâ”€ README
â”‚  â”œâ”€ API specs (Swagger)
â”‚  â””â”€ Diagrammes
â”œâ”€ Database
â”‚  â”œâ”€ Migrations
â”‚  â”œâ”€ Seed data
â”‚  â””â”€ Index perfs
â””â”€ Rapports
   â”œâ”€ PDF templates
   â””â”€ Excel exports
```

---

**Document gÃ©nÃ©rÃ© le** : 2025-04-24
**Version** : 1.0 Final
**Scope** : Ajout tickets + situations journaliÃ¨res (Module Transport existant)